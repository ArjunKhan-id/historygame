<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Ular Tangga Digital - Sejarah Indonesia</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a3a8f 0%, #0d6efd 100%);
            color: #333;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px;
            margin-bottom: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            border-bottom: 5px solid #ffc107;
        }
        
        h1 {
            color: #1a3a8f;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 15px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .info-box {
            flex: 1;
            min-width: 200px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .info-box h3 {
            color: #1a3a8f;
            margin-bottom: 10px;
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 5px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .game-board-container {
            flex: 3;
            min-width: 300px;
        }
        
        .game-board {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            grid-gap: 2px;
            background-color: #0a58ca;
            padding: 10px;
            border-radius: 10px;
            position: relative;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }
        
        .cell {
            aspect-ratio: 1;
            background-color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border-radius: 5px;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .cell:hover {
            transform: scale(1.05);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
        }
        
        .cell.even {
            background-color: #e7f1ff;
        }
        
        .cell.odd {
            background-color: #ffffff;
        }
        
        .cell-number {
            position: absolute;
            top: 3px;
            left: 3px;
            font-size: 0.8rem;
            color: #666;
        }
        
        .question-mark {
            color: #ffc107;
            font-size: 1.5rem;
            position: absolute;
            bottom: 5px;
            right: 5px;
        }
        
        .player-token {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            position: absolute;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .player-1 {
            background-color: #0d6efd;
            top: 5px;
            left: 5px;
        }
        
        .player-2 {
            background-color: #198754;
            top: 5px;
            right: 5px;
        }
        
        .player-3 {
            background-color: #ffc107;
            bottom: 5px;
            left: 5px;
        }
        
        .player-4 {
            background-color: #fd7e14;
            bottom: 5px;
            right: 5px;
        }
        
        .active-cell {
            box-shadow: 0 0 0 3px #20c997, 0 0 15px #20c997;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 3px rgba(32, 201, 151, 0.7); }
            50% { box-shadow: 0 0 0 6px rgba(32, 201, 151, 0.4); }
            100% { box-shadow: 0 0 0 3px rgba(32, 201, 151, 0.7); }
        }
        
        .snake, .ladder {
            position: absolute;
            z-index: 1;
            pointer-events: none;
        }
        
        .snake {
            border-bottom: 4px dashed #dc3545;
            border-radius: 50%;
        }
        
        .ladder {
            border-left: 4px solid #20c997;
            border-radius: 2px;
        }
        
        .ladder-step {
            position: absolute;
            width: 10px;
            height: 2px;
            background-color: #20c997;
        }
        
        .snake-head {
            color: #dc3545;
            position: absolute;
            font-size: 1.2rem;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .snake-tail {
            color: #dc3545;
            position: absolute;
            font-size: 1rem;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .ladder-top {
            color: #20c997;
            position: absolute;
            font-size: 1.2rem;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .ladder-bottom {
            color: #20c997;
            position: absolute;
            font-size: 1rem;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
        }
        
        .game-controls {
            flex: 2;
            min-width: 300px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .dice-container {
            text-align: center;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #dee2e6;
        }
        
        .dice {
            width: 80px;
            height: 80px;
            margin: 15px auto;
            background-color: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            font-weight: bold;
            color: #1a3a8f;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .dice:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }
        
        .dice.rolling {
            animation: rollDice 1s ease-in-out;
        }
        
        @keyframes rollDice {
            0% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(90deg) scale(1.1); }
            50% { transform: rotate(180deg) scale(1); }
            75% { transform: rotate(270deg) scale(1.1); }
            100% { transform: rotate(360deg) scale(1); }
        }
        
        .roll-btn {
            background-color: #0d6efd;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            margin-top: 10px;
        }
        
        .roll-btn:hover {
            background-color: #0b5ed7;
            transform: translateY(-2px);
        }
        
        .roll-btn:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
            transform: none;
        }
        
        .turn-info {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .turn-info h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .current-player {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1a3a8f;
            padding: 5px 15px;
            border-radius: 20px;
            display: inline-block;
            margin-top: 5px;
        }
        
        .players-status {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .player-status {
            padding: 10px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .player-status.active {
            background-color: #d1e7dd;
            border: 2px solid #198754;
        }
        
        .player-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
        }
        
        .question-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .question-content {
            background-color: white;
            width: 90%;
            max-width: 600px;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
        }
        
        .question-content h3 {
            color: #1a3a8f;
            margin-bottom: 20px;
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 10px;
        }
        
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 25px;
            line-height: 1.5;
        }
        
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .option {
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .option:hover {
            background-color: #f8f9fa;
            border-color: #adb5bd;
        }
        
        .option.correct {
            background-color: #d1e7dd;
            border-color: #198754;
            color: #0f5132;
        }
        
        .option.incorrect {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }
        
        .feedback.correct {
            background-color: #d1e7dd;
            border: 2px solid #198754;
            color: #0f5132;
        }
        
        .feedback.incorrect {
            background-color: #f8d7da;
            border: 2px solid #dc3545;
            color: #721c24;
        }
        
        .close-btn, .next-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .close-btn {
            background-color: #6c757d;
            color: white;
        }
        
        .next-btn {
            background-color: #0d6efd;
            color: white;
            margin-left: 10px;
        }
        
        .game-result {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }
        
        .result-content {
            background-color: white;
            width: 90%;
            max-width: 700px;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .confetti {
            position: absolute;
            width: 15px;
            height: 15px;
            background-color: #ffc107;
            top: -20px;
            animation: fall 5s linear infinite;
        }
        
        @keyframes fall {
            to {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        .winner-badge {
            background-color: #ffc107;
            color: #856404;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            display: inline-block;
            margin: 20px auto;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .result-players {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        .result-player {
            padding: 15px;
            border-radius: 10px;
            min-width: 150px;
            background-color: #f8f9fa;
        }
        
        .result-player.winner {
            background-color: #fff3cd;
            border: 3px solid #ffc107;
            transform: scale(1.05);
        }
        
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }
        
        .action-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .restart-btn {
            background-color: #198754;
            color: white;
        }
        
        .menu-btn {
            background-color: #0d6efd;
            color: white;
        }
        
        .exit-btn {
            background-color: #dc3545;
            color: white;
        }
        
        .rules-btn, .start-btn {
            position: fixed;
            bottom: 20px;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
        }
        
        .rules-btn {
            left: 20px;
            background-color: #6c757d;
            color: white;
        }
        
        .start-btn {
            right: 20px;
            background-color: #198754;
            color: white;
        }
        
        .rules-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1500;
        }
        
        .rules-content {
            background-color: white;
            width: 90%;
            max-width: 800px;
            border-radius: 15px;
            padding: 30px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .rules-content h2 {
            color: #1a3a8f;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .rules-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .rule-item {
            padding: 10px;
            border-left: 4px solid #0d6efd;
            background-color: #f8f9fa;
            border-radius: 0 8px 8px 0;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            
            .game-board {
                grid-template-columns: repeat(10, 1fr);
            }
            
            .cell {
                font-size: 0.7rem;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        .sound-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            color: #1a3a8f;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }
        
        .snake-ladder-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .snake-legend {
            background-color: #dc3545;
        }
        
        .ladder-legend {
            background-color: #20c997;
        }
    </style>
</head>
<body>
    <button class="sound-toggle" id="soundToggle">
        <i class="fas fa-volume-up"></i>
    </button>
    
    <div class="container">
        <header>
            <h1>üé≤ Game Ular Tangga Digital Interaktif</h1>
            <p class="subtitle">Mata Pelajaran Sejarah Indonesia - Kelas X SMA</p>
            <p>Materi: Kerajaan Banjar & Kerajaan Kutai Kartanegara</p>
        </header>
        
        <div class="game-info">
            <div class="info-box">
                <h3>üìã Aturan Permainan</h3>
                <p>Dimainkan oleh 4 kelompok. Setiap kelompok akan mendapat pertanyaan sejarah saat mendarat di kotak genap. Jawab benar untuk maju!</p>
            </div>
            <div class="info-box">
                <h3>üéØ Tujuan Pembelajaran</h3>
                <p>Memahami sejarah Kerajaan Banjar dan Kerajaan Kutai Kartanegara dengan cara yang menyenangkan dan interaktif.</p>
            </div>
            <div class="info-box">
                <h3>üêçü™ú Ular & Tangga</h3>
                <div class="snake-ladder-legend">
                    <div class="legend-item">
                        <div class="legend-color snake-legend"></div>
                        <span>Ular: Turun beberapa petak</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color ladder-legend"></div>
                        <span>Tangga: Naik beberapa petak</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="main-content">
            <div class="game-board-container">
                <div class="game-board" id="gameBoard">
                    <!-- Papan permainan akan di-generate oleh JavaScript -->
                </div>
            </div>
            
            <div class="game-controls">
                <div class="dice-container">
                    <h3>üé≤ Lempar Dadu</h3>
                    <div class="dice" id="dice">?</div>
                    <button class="roll-btn" id="rollBtn">Lempar Dadu</button>
                    <p id="diceResult" style="margin-top: 10px; font-weight: bold; color: #1a3a8f;"></p>
                </div>
                
                <div class="turn-info">
                    <h3>üîÑ Giliran Sekarang</h3>
                    <div class="current-player" id="currentPlayer">Kelompok 1</div>
                    <p id="currentPosition" style="margin-top: 10px;">Posisi: Petak 1</p>
                </div>
                
                <div class="players-status">
                    <h3 style="grid-column: 1 / span 2; color: #1a3a8f; margin-bottom: 10px;">üìä Status Pemain</h3>
                    <div class="player-status active" id="player1Status">
                        <div class="player-color player-1"></div>
                        <div>
                            <strong>Kelompok 1</strong><br>
                            <span id="player1Pos">Petak 1</span>
                        </div>
                    </div>
                    <div class="player-status" id="player2Status">
                        <div class="player-color player-2"></div>
                        <div>
                            <strong>Kelompok 2</strong><br>
                            <span id="player2Pos">Petak 1</span>
                        </div>
                    </div>
                    <div class="player-status" id="player3Status">
                        <div class="player-color player-3"></div>
                        <div>
                            <strong>Kelompok 3</strong><br>
                            <span id="player3Pos">Petak 1</span>
                        </div>
                    </div>
                    <div class="player-status" id="player4Status">
                        <div class="player-color player-4"></div>
                        <div>
                            <strong>Kelompok 4</strong><br>
                            <span id="player4Pos">Petak 1</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal Pertanyaan -->
    <div class="question-modal" id="questionModal">
        <div class="question-content">
            <h3>‚ùì Pertanyaan Sejarah</h3>
            <div class="question-text" id="questionText"></div>
            <div class="options-container" id="optionsContainer"></div>
            <div class="feedback" id="feedback"></div>
            <div style="text-align: right; margin-top: 20px;">
                <button class="close-btn" id="closeBtn">Tutup</button>
                <button class="next-btn" id="nextBtn" style="display: none;">Lanjutkan</button>
            </div>
        </div>
    </div>
    
    <!-- Modal Hasil Akhir -->
    <div class="game-result" id="gameResult">
        <div class="result-content">
            <div class="confetti" style="left: 10%; animation-delay: 0s;"></div>
            <div class="confetti" style="left: 20%; animation-delay: 1s;"></div>
            <div class="confetti" style="left: 30%; animation-delay: 0.5s;"></div>
            <div class="confetti" style="left: 40%; animation-delay: 1.5s;"></div>
            <div class="confetti" style="left: 50%; animation-delay: 0.8s;"></div>
            <div class="confetti" style="left: 60%; animation-delay: 1.2s;"></div>
            <div class="confetti" style="left: 70%; animation-delay: 0.3s;"></div>
            <div class="confetti" style="left: 80%; animation-delay: 1.7s;"></div>
            <div class="confetti" style="left: 90%; animation-delay: 0.6s;"></div>
            
            <h2>üèÜ SELAMAT! PERMAINAN SELESAI üèÜ</h2>
            <div class="winner-badge" id="winnerBadge">JUARA ULAR TANGGA SEJARAH</div>
            <p id="winnerText">Kelompok 1 MENANG!</p>
            
            <div class="result-players" id="resultPlayers">
                <!-- Hasil pemain akan diisi oleh JavaScript -->
            </div>
            
            <div class="action-buttons">
                <button class="action-btn restart-btn" id="restartBtn">üîÑ Main Lagi</button>
                <button class="action-btn menu-btn" id="menuBtn">üè† Kembali ke Menu</button>
                <button class="action-btn exit-btn" id="exitBtn">‚ùå Keluar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal Aturan -->
    <div class="rules-modal" id="rulesModal">
        <div class="rules-content">
            <h2>üìú Aturan Bermain</h2>
            <div class="rules-list">
                <div class="rule-item">
                    <strong>1. Jumlah Pemain:</strong> Permainan dimainkan oleh 4 kelompok (Kelompok 1, 2, 3, dan 4).
                </div>
                <div class="rule-item">
                    <strong>2. Giliran Bermain:</strong> Giliran dimulai dari Kelompok 1 ‚Üí 2 ‚Üí 3 ‚Üí 4 secara bergantian.
                </div>
                <div class="rule-item">
                    <strong>3. Lempar Dadu:</strong> Setiap giliran, kelompok melemparkan dadu untuk menentukan jumlah langkah.
                </div>
                <div class="rule-item">
                    <strong>4. Pertanyaan Sejarah:</strong> Jika mendarat di kotak bernomor genap, akan muncul pertanyaan pilihan ganda tentang Kerajaan Banjar dan Kerajaan Kutai Kartanegara.
                </div>
                <div class="rule-item">
                    <strong>5. Aturan Jawaban:</strong> 
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>‚úÖ Jawaban benar ‚Üí pion maju sesuai angka dadu</li>
                        <li>‚ùå Jawaban salah ‚Üí pion tetap di tempat</li>
                    </ul>
                </div>
                <div class="rule-item">
                    <strong>6. Ular dan Tangga:</strong>
                    <ul style="margin-left: 20px; margin-top: 5px;">
                        <li>üêç Ular: Jika mendarat di kepala ular, turun ke ekor ular</li>
                        <li>ü™ú Tangga: Jika mendarat di bawah tangga, naik ke atas tangga</li>
                    </ul>
                </div>
                <div class="rule-item">
                    <strong>7. Pemenang:</strong> Kelompok pertama yang mencapai kotak finish (kotak 50) adalah pemenangnya.
                </div>
                <div class="rule-item">
                    <strong>8. Tujuan Edukasi:</strong> Game ini bertujuan untuk memperkuat pemahaman sejarah Indonesia dengan cara yang menyenangkan.
                </div>
            </div>
            <div style="text-align: center; margin-top: 20px;">
                <button class="action-btn menu-btn" id="closeRulesBtn">Mengerti, Mari Bermain!</button>
            </div>
        </div>
    </div>
    
    <button class="rules-btn" id="showRulesBtn">üìú Aturan Bermain</button>
    <button class="start-btn" id="startBtn">‚ñ∂Ô∏è Mulai Game</button>

    <!-- Audio elements -->
    <audio id="diceSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-dice-roll-1994.mp3" preload="auto"></audio>
    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3" preload="auto"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3" preload="auto"></audio>
    <audio id="ladderSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3" preload="auto"></audio>
    <audio id="snakeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-snake-hiss-1091.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3" preload="auto"></audio>

    <script>
        // Game state
        const gameState = {
            players: [
                { id: 1, name: "Kelompok 1", position: 1, color: "#0d6efd", active: true },
                { id: 2, name: "Kelompok 2", position: 1, color: "#198754", active: false },
                { id: 3, name: "Kelompok 3", position: 1, color: "#ffc107", active: false },
                { id: 4, name: "Kelompok 4", position: 1, color: "#fd7e14", active: false }
            ],
            currentPlayerIndex: 0,
            gameStarted: false,
            gameFinished: false,
            diceValue: 0,
            questionsUsed: [],
            snakes: {
                40: 20,
                33: 27,
                25: 15,
                48: 30,
                36: 22
            },
            ladders: {
                6: 18,
                16: 36,
                13: 31,
                8: 26,
                21: 42
            },
            soundsEnabled: true
        };

        // Questions database - Kerajaan Banjar dan Kutai Kartanegara
        const questions = [
            {
                id: 1,
                question: "Siapakah pendiri Kerajaan Kutai Kartanegara?",
                options: ["Kudungga", "Mulawarman", "Aswawarman", "Pangeran Samudera"],
                answer: 0,
                explanation: "Kudungga adalah pendiri Kerajaan Kutai Kartanegara yang tercatat dalam prasasti Yupa."
            },
            {
                id: 2,
                question: "Prasasti apa yang menjadi sumber sejarah Kerajaan Kutai Kartanegara?",
                options: ["Prasasti Yupa", "Prasasti Ciaruteun", "Prasasti Talang Tuwo", "Prasasti Kebon Kopi"],
                answer: 0,
                explanation: "Prasasti Yupa adalah prasasti batu yang menjadi sumber utama sejarah Kerajaan Kutai Kartanegara."
            },
            {
                id: 3,
                question: "Siapakah raja pertama Kerajaan Banjar yang memeluk Islam?",
                options: ["Pangeran Samudera", "Sultan Suriansyah", "Pangeran Tumenggung", "Sultan Rahmatullah"],
                answer: 1,
                explanation: "Sultan Suriansyah adalah raja pertama Kerajaan Banjar yang memeluk Islam setelah sebelumnya bernama Pangeran Samudera."
            },
            {
                id: 4,
                question: "Di mana lokasi ibu kota Kerajaan Kutai Kartanegara?",
                options: ["Muara Kaman", "Martapura", "Banjarmasin", "Tanjungpura"],
                answer: 0,
                explanation: "Ibu kota Kerajaan Kutai Kartanegara berada di Muara Kaman, Kalimantan Timur."
            },
            {
                id: 5,
                question: "Kerajaan Banjar mencapai puncak kejayaan pada masa pemerintahan siapa?",
                options: ["Sultan Suriansyah", "Sultan Adam", "Pangeran Antasari", "Sultan Tahmidullah II"],
                answer: 3,
                explanation: "Kerajaan Banjar mencapai puncak kejayaan pada masa pemerintahan Sultan Tahmidullah II (1785-1808)."
            },
            {
                id: 6,
                question: "Apa nama upacara pemberian gelar pada masyarakat Kutai Kartanegara?",
                options: ["Erau", "Mappanretasi", "Aruh", "Tiwah"],
                answer: 0,
                explanation: "Erau adalah upacara adat pemberian gelar pada masyarakat Kutai Kartanegara yang masih dilestarikan hingga sekarang."
            },
            {
                id: 7,
                question: "Siapakah raja Kutai Kartanegara yang terkenal dengan sumpahnya untuk tidak memakan daging sapi?",
                options: ["Kudungga", "Mulawarman", "Aji Batara Agung Dewa Sakti", "Aswawarman"],
                answer: 2,
                explanation: "Aji Batara Agung Dewa Sakti adalah raja Kutai Kartanegara yang terkenal dengan sumpahnya untuk tidak memakan daging sapi."
            },
            {
                id: 8,
                question: "Pada abad ke berapakah Kerajaan Banjar berdiri?",
                options: ["Abad ke-14", "Abad ke-15", "Abad ke-16", "Abad ke-17"],
                answer: 2,
                explanation: "Kerajaan Banjar berdiri pada abad ke-16, tepatnya tahun 1526 Masehi."
            },
            {
                id: 9,
                question: "Apa mata pencaharian utama masyarakat Kerajaan Kutai Kartanegara?",
                options: ["Perdagangan", "Pertanian", "Perikanan", "Pertambangan"],
                answer: 0,
                explanation: "Mata pencaharian utama masyarakat Kerajaan Kutai Kartanegara adalah perdagangan karena letaknya yang strategis di tepi Sungai Mahakam."
            },
            {
                id: 10,
                question: "Siapakah pahlawan dari Kerajaan Banjar yang memimpin Perang Banjar?",
                options: ["Sultan Suriansyah", "Pangeran Hidayatullah", "Pangeran Antasari", "Sultan Adam"],
                answer: 2,
                explanation: "Pangeran Antasari adalah pahlawan dari Kerajaan Banjar yang memimpin Perang Banjar melawan penjajah Belanda."
            },
            {
                id: 11,
                question: "Apa nama kerajaan Hindu tertua di Indonesia?",
                options: ["Kutai Kartanegara", "Tarumanegara", "Kalingga", "Majapahit"],
                answer: 0,
                explanation: "Kutai Kartanegara di Kalimantan Timur dianggap sebagai kerajaan Hindu tertua di Indonesia."
            },
            {
                id: 12,
                question: "Di mana letak pusat pemerintahan Kerajaan Banjar?",
                options: ["Banjarmasin", "Martapura", "Kota Waringin", "Amuntai"],
                answer: 1,
                explanation: "Pusat pemerintahan Kerajaan Banjar berada di Martapura, Kalimantan Selatan."
            },
            {
                id: 13,
                question: "Siapakah raja Kutai Kartanegara yang pertama kali memeluk Islam?",
                options: ["Aji Batara Agung Dewa Sakti", "Aji Pangeran Sinum Panji Mendapa", "Aji Muhammad Idris", "Aji Imbut"],
                answer: 2,
                explanation: "Aji Muhammad Idris adalah raja Kutai Kartanegara yang pertama kali memeluk Islam pada abad ke-18."
            },
            {
                id: 14,
                question: "Apa nama sungai yang menjadi pusat kehidupan Kerajaan Banjar?",
                options: ["Sungai Kapuas", "Sungai Mahakam", "Sungai Barito", "Sungai Martapura"],
                answer: 2,
                explanation: "Sungai Barito adalah sungai yang menjadi pusat kehidupan dan perdagangan Kerajaan Banjar."
            },
            {
                id: 15,
                question: "Kapan Kerajaan Kutai Kartanegara berdiri?",
                options: ["Abad ke-4 Masehi", "Abad ke-5 Masehi", "Abad ke-13 Masehi", "Abad ke-16 Masehi"],
                answer: 0,
                explanation: "Kerajaan Kutai Kartanegara berdiri pada sekitar abad ke-4 Masehi berdasarkan prasasti Yupa."
            }
        ];

        // DOM elements
        const gameBoard = document.getElementById('gameBoard');
        const diceElement = document.getElementById('dice');
        const rollBtn = document.getElementById('rollBtn');
        const currentPlayerElement = document.getElementById('currentPlayer');
        const currentPositionElement = document.getElementById('currentPosition');
        const questionModal = document.getElementById('questionModal');
        const questionText = document.getElementById('questionText');
        const optionsContainer = document.getElementById('optionsContainer');
        const feedbackElement = document.getElementById('feedback');
        const closeBtn = document.getElementById('closeBtn');
        const nextBtn = document.getElementById('nextBtn');
        const gameResult = document.getElementById('gameResult');
        const winnerText = document.getElementById('winnerText');
        const resultPlayers = document.getElementById('resultPlayers');
        const restartBtn = document.getElementById('restartBtn');
        const menuBtn = document.getElementById('menuBtn');
        const exitBtn = document.getElementById('exitBtn');
        const startBtn = document.getElementById('startBtn');
        const showRulesBtn = document.getElementById('showRulesBtn');
        const rulesModal = document.getElementById('rulesModal');
        const closeRulesBtn = document.getElementById('closeRulesBtn');
        const soundToggle = document.getElementById('soundToggle');
        
        // Audio elements
        const diceSound = document.getElementById('diceSound');
        const correctSound = document.getElementById('correctSound');
        const wrongSound = document.getElementById('wrongSound');
        const ladderSound = document.getElementById('ladderSound');
        const snakeSound = document.getElementById('snakeSound');
        const winSound = document.getElementById('winSound');

        // Initialize the game board
        function initGameBoard() {
            gameBoard.innerHTML = '';
            
            // Create 50 cells (5x10 grid)
            for (let i = 1; i <= 50; i++) {
                const cell = document.createElement('div');
                cell.className = 'cell';
                cell.id = `cell${i}`;
                
                // Determine if even or odd
                if (i % 2 === 0) {
                    cell.classList.add('even');
                } else {
                    cell.classList.add('odd');
                }
                
                // Add cell number
                const cellNumber = document.createElement('div');
                cellNumber.className = 'cell-number';
                cellNumber.textContent = i;
                cell.appendChild(cellNumber);
                
                // Add question mark for even cells
                if (i % 2 === 0) {
                    const questionMark = document.createElement('div');
                    questionMark.className = 'question-mark';
                    questionMark.innerHTML = '‚ùì';
                    cell.appendChild(questionMark);
                }
                
                // Add player tokens initially at cell 1
                if (i === 1) {
                    for (let j = 0; j < 4; j++) {
                        const token = document.createElement('div');
                        token.className = `player-token player-${j+1}`;
                        token.id = `player${j+1}Token`;
                        cell.appendChild(token);
                    }
                }
                
                gameBoard.appendChild(cell);
            }
            
            // Create snakes and ladders
            createSnakesAndLadders();
        }

        // Create visual snakes and ladders on the board
        function createSnakesAndLadders() {
            // Create snakes
            for (const [start, end] of Object.entries(gameState.snakes)) {
                createSnake(parseInt(start), parseInt(end));
            }
            
            // Create ladders
            for (const [start, end] of Object.entries(gameState.ladders)) {
                createLadder(parseInt(start), parseInt(end));
            }
        }

        // Create a snake visual from start to end cell
        function createSnake(start, end) {
            const startCell = document.getElementById(`cell${start}`);
            const endCell = document.getElementById(`cell${end}`);
            
            if (!startCell || !endCell) return;
            
            // Calculate positions
            const startRect = startCell.getBoundingClientRect();
            const endRect = endCell.getBoundingClientRect();
            const boardRect = gameBoard.getBoundingClientRect();
            
            const startX = startRect.left + startRect.width / 2 - boardRect.left;
            const startY = startRect.top + startRect.height / 2 - boardRect.top;
            const endX = endRect.left + endRect.width / 2 - boardRect.left;
            const endY = endRect.top + endRect.height / 2 - boardRect.top;
            
            // Create snake element
            const snake = document.createElement('div');
            snake.className = 'snake';
            
            // Set snake path
            const distance = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
            
            snake.style.width = `${distance}px`;
            snake.style.height = '4px';
            snake.style.left = `${startX}px`;
            snake.style.top = `${startY}px`;
            snake.style.transform = `rotate(${angle}deg)`;
            snake.style.transformOrigin = 'top left';
            
            // Add snake head and tail
            const snakeHead = document.createElement('div');
            snakeHead.className = 'snake-head';
            snakeHead.innerHTML = 'üêç';
            snakeHead.style.transform = `rotate(${-angle}deg)`;
            snake.appendChild(snakeHead);
            
            const snakeTail = document.createElement('div');
            snakeTail.className = 'snake-tail';
            snakeTail.innerHTML = '‚¨áÔ∏è';
            snakeTail.style.transform = `translateX(${distance}px) rotate(${-angle}deg)`;
            snake.appendChild(snakeTail);
            
            gameBoard.appendChild(snake);
            
            // Add snake indicator to cells
            startCell.style.backgroundColor = '#f8d7da';
            endCell.style.backgroundColor = '#f8d7da';
        }

        // Create a ladder visual from start to end cell
        function createLadder(start, end) {
            const startCell = document.getElementById(`cell${start}`);
            const endCell = document.getElementById(`cell${end}`);
            
            if (!startCell || !endCell) return;
            
            // Calculate positions
            const startRect = startCell.getBoundingClientRect();
            const endRect = endCell.getBoundingClientRect();
            const boardRect = gameBoard.getBoundingClientRect();
            
            const startX = startRect.left + startRect.width / 2 - boardRect.left;
            const startY = startRect.top + startRect.height / 2 - boardRect.top;
            const endX = endRect.left + endRect.width / 2 - boardRect.left;
            const endY = endRect.top + endRect.height / 2 - boardRect.top;
            
            // Create ladder element
            const ladder = document.createElement('div');
            ladder.className = 'ladder';
            
            // Set ladder path
            const distance = Math.sqrt(Math.pow(endX - startX, 2) + Math.pow(endY - startY, 2));
            const angle = Math.atan2(endY - startY, endX - startX) * 180 / Math.PI;
            
            ladder.style.width = '4px';
            ladder.style.height = `${distance}px`;
            ladder.style.left = `${startX}px`;
            ladder.style.top = `${startY}px`;
            ladder.style.transform = `rotate(${angle}deg)`;
            ladder.style.transformOrigin = 'top left';
            
            // Add ladder steps
            const stepCount = 5;
            for (let i = 1; i < stepCount; i++) {
                const step = document.createElement('div');
                step.className = 'ladder-step';
                step.style.left = '0px';
                step.style.top = `${(distance / stepCount) * i}px`;
                step.style.transform = `rotate(${-angle}deg)`;
                ladder.appendChild(step);
            }
            
            // Add ladder top and bottom
            const ladderTop = document.createElement('div');
            ladderTop.className = 'ladder-top';
            ladderTop.innerHTML = 'ü™ú';
            ladderTop.style.transform = `rotate(${-angle}deg)`;
            ladder.appendChild(ladderTop);
            
            const ladderBottom = document.createElement('div');
            ladderBottom.className = 'ladder-bottom';
            ladderBottom.innerHTML = '‚¨ÜÔ∏è';
            ladderBottom.style.transform = `translateY(${distance}px) rotate(${-angle}deg)`;
            ladder.appendChild(ladderBottom);
            
            gameBoard.appendChild(ladder);
            
            // Add ladder indicator to cells
            startCell.style.backgroundColor = '#d1e7dd';
            endCell.style.backgroundColor = '#d1e7dd';
        }

        // Update player positions on the board
        function updatePlayerPositions() {
            // Remove all player tokens from cells
            for (let i = 1; i <= 50; i++) {
                const cell = document.getElementById(`cell${i}`);
                const tokens = cell.querySelectorAll('.player-token');
                tokens.forEach(token => token.remove());
            }
            
            // Add player tokens to their current positions
            gameState.players.forEach(player => {
                const cell = document.getElementById(`cell${player.position}`);
                if (cell) {
                    const token = document.createElement('div');
                    token.className = `player-token player-${player.id}`;
                    token.id = `player${player.id}Token`;
                    cell.appendChild(token);
                    
                    // Highlight active player's cell
                    if (player.active) {
                        cell.classList.add('active-cell');
                    } else {
                        cell.classList.remove('active-cell');
                    }
                }
            });
            
            // Update player status displays
            updatePlayerStatus();
        }

        // Update player status UI
        function updatePlayerStatus() {
            gameState.players.forEach(player => {
                const playerStatus = document.getElementById(`player${player.id}Status`);
                const playerPos = document.getElementById(`player${player.id}Pos`);
                
                if (playerStatus && playerPos) {
                    playerPos.textContent = `Petak ${player.position}`;
                    
                    if (player.active) {
                        playerStatus.classList.add('active');
                        currentPlayerElement.textContent = player.name;
                        currentPlayerElement.style.backgroundColor = player.color;
                        currentPositionElement.textContent = `Posisi: Petak ${player.position}`;
                    } else {
                        playerStatus.classList.remove('active');
                    }
                }
            });
        }

        // Roll the dice
        function rollDice() {
            if (!gameState.gameStarted || gameState.gameFinished) return;
            
            // Disable roll button during dice roll
            rollBtn.disabled = true;
            
            // Play dice sound
            if (gameState.soundsEnabled) {
                diceSound.currentTime = 0;
                diceSound.play();
            }
            
            // Add rolling animation
            diceElement.classList.add('rolling');
            diceElement.textContent = '?';
            
            // Simulate dice roll
            let rollCount = 0;
            const maxRolls = 10;
            const rollInterval = setInterval(() => {
                gameState.diceValue = Math.floor(Math.random() * 6) + 1;
                diceElement.textContent = gameState.diceValue;
                rollCount++;
                
                if (rollCount >= maxRolls) {
                    clearInterval(rollInterval);
                    diceElement.classList.remove('rolling');
                    
                    // Show dice result
                    document.getElementById('diceResult').textContent = `Anda mendapatkan angka ${gameState.diceValue}`;
                    
                    // Move player after a short delay
                    setTimeout(() => {
                        movePlayer(gameState.diceValue);
                    }, 1000);
                }
            }, 100);
        }

        // Move player based on dice value
        function movePlayer(steps) {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            const newPosition = currentPlayer.position + steps;
            
            // Check if player would go beyond the board
            if (newPosition > 50) {
                // Player stays in place if they overshoot
                document.getElementById('diceResult').textContent = `Angka terlalu besar! Anda tetap di petak ${currentPlayer.position}`;
                nextTurn();
                return;
            }
            
            // Move player to new position
            currentPlayer.position = newPosition;
            updatePlayerPositions();
            
            // Check for win
            if (newPosition === 50) {
                endGame(currentPlayer);
                return;
            }
            
            // Check if landed on even cell (question cell)
            if (newPosition % 2 === 0) {
                // Show question after a short delay
                setTimeout(() => {
                    showQuestion();
                }, 800);
            } else {
                // Check for snake or ladder
                checkSnakeOrLadder(newPosition);
            }
        }

        // Check if player landed on a snake or ladder
        function checkSnakeOrLadder(position) {
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            let moved = false;
            let message = '';
            
            // Check for snake
            if (gameState.snakes[position]) {
                const newPosition = gameState.snakes[position];
                currentPlayer.position = newPosition;
                moved = true;
                message = `Anda terkena ular! Turun ke petak ${newPosition}`;
                
                // Play snake sound
                if (gameState.soundsEnabled) {
                    snakeSound.currentTime = 0;
                    snakeSound.play();
                }
            }
            
            // Check for ladder
            if (gameState.ladders[position]) {
                const newPosition = gameState.ladders[position];
                currentPlayer.position = newPosition;
                moved = true;
                message = `Anda menemukan tangga! Naik ke petak ${newPosition}`;
                
                // Play ladder sound
                if (gameState.soundsEnabled) {
                    ladderSound.currentTime = 0;
                    ladderSound.play();
                }
            }
            
            if (moved) {
                // Update positions and show message
                updatePlayerPositions();
                document.getElementById('diceResult').textContent = message;
                
                // Check for win after snake/ladder move
                if (currentPlayer.position === 50) {
                    setTimeout(() => {
                        endGame(currentPlayer);
                    }, 1000);
                    return;
                }
            }
            
            // Continue to next turn after a delay
            setTimeout(() => {
                nextTurn();
            }, moved ? 1500 : 500);
        }

        // Show a question to the player
        function showQuestion() {
            // Get a random question that hasn't been used
            let availableQuestions = questions.filter(q => !gameState.questionsUsed.includes(q.id));
            
            if (availableQuestions.length === 0) {
                // If all questions have been used, reset the used questions
                gameState.questionsUsed = [];
                availableQuestions = questions;
            }
            
            const randomIndex = Math.floor(Math.random() * availableQuestions.length);
            const question = availableQuestions[randomIndex];
            
            // Mark question as used
            gameState.questionsUsed.push(question.id);
            
            // Display question
            questionText.textContent = question.question;
            optionsContainer.innerHTML = '';
            
            // Create options
            question.options.forEach((option, index) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = `${String.fromCharCode(65 + index)}. ${option}`;
                optionElement.dataset.index = index;
                
                optionElement.addEventListener('click', () => {
                    checkAnswer(question, index);
                });
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Reset feedback
            feedbackElement.style.display = 'none';
            feedbackElement.className = 'feedback';
            nextBtn.style.display = 'none';
            
            // Show modal
            questionModal.style.display = 'flex';
        }

        // Check the answer to a question
        function checkAnswer(question, selectedIndex) {
            const options = document.querySelectorAll('.option');
            const currentPlayer = gameState.players[gameState.currentPlayerIndex];
            
            // Disable all options
            options.forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // Mark correct and incorrect answers
            options.forEach(option => {
                const optionIndex = parseInt(option.dataset.index);
                
                if (optionIndex === question.answer) {
                    option.classList.add('correct');
                } else if (optionIndex === selectedIndex) {
                    option.classList.add('incorrect');
                }
            });
            
            // Show feedback
            feedbackElement.style.display = 'block';
            
            if (selectedIndex === question.answer) {
                // Correct answer
                feedbackElement.classList.add('correct');
                feedbackElement.innerHTML = `<strong>‚úÖ Jawaban benar!</strong> ${question.explanation}<br>Kamu maju ${gameState.diceValue} petak!`;
                
                // Play correct sound
                if (gameState.soundsEnabled) {
                    correctSound.currentTime = 0;
                    correctSound.play();
                }
                
                // Player already moved from dice roll, just continue
            } else {
                // Wrong answer
                feedbackElement.classList.add('incorrect');
                feedbackElement.innerHTML = `<strong>‚ùå Jawaban salah!</strong> ${question.explanation}<br>Jawaban benar: ${String.fromCharCode(65 + question.answer)}. ${question.options[question.answer]}<br>Kamu tetap di tempat.`;
                
                // Play wrong sound
                if (gameState.soundsEnabled) {
                    wrongSound.currentTime = 0;
                    wrongSound.play();
                }
                
                // Move player back to previous position (they don't get to move)
                currentPlayer.position -= gameState.diceValue;
                updatePlayerPositions();
            }
            
            // Show next button
            nextBtn.style.display = 'inline-block';
        }

        // Advance to next player's turn
        function nextTurn() {
            // Re-enable roll button
            rollBtn.disabled = false;
            
            // Reset dice display
            diceElement.textContent = '?';
            document.getElementById('diceResult').textContent = '';
            
            // Move to next player
            gameState.players[gameState.currentPlayerIndex].active = false;
            gameState.currentPlayerIndex = (gameState.currentPlayerIndex + 1) % 4;
            gameState.players[gameState.currentPlayerIndex].active = true;
            
            // Update UI
            updatePlayerPositions();
        }

        // End the game
        function endGame(winner) {
            gameState.gameFinished = true;
            rollBtn.disabled = true;
            
            // Play win sound
            if (gameState.soundsEnabled) {
                winSound.currentTime = 0;
                winSound.play();
            }
            
            // Update winner text
            winnerText.textContent = `${winner.name} MENANG!`;
            document.getElementById('winnerBadge').textContent = `JUARA ULAR TANGGA SEJARAH - ${winner.name}`;
            
            // Create result players display
            resultPlayers.innerHTML = '';
            gameState.players.forEach(player => {
                const playerResult = document.createElement('div');
                playerResult.className = `result-player ${player.id === winner.id ? 'winner' : ''}`;
                playerResult.innerHTML = `
                    <h3>${player.name}</h3>
                    <p>Posisi akhir: Petak ${player.position}</p>
                    ${player.id === winner.id ? '<p>üèÜ PEMENANG üèÜ</p>' : ''}
                `;
                resultPlayers.appendChild(playerResult);
            });
            
            // Show result modal after a delay
            setTimeout(() => {
                gameResult.style.display = 'flex';
            }, 1500);
        }

        // Start the game
        function startGame() {
            gameState.gameStarted = true;
            gameState.gameFinished = false;
            gameState.questionsUsed = [];
            
            // Reset player positions
            gameState.players.forEach(player => {
                player.position = 1;
                player.active = (player.id === 1);
            });
            
            gameState.currentPlayerIndex = 0;
            
            // Update UI
            updatePlayerPositions();
            rollBtn.disabled = false;
            
            // Show start message
            alert("Game dimulai! Giliran pertama: Kelompok 1. Tekan 'Lempar Dadu' untuk memulai.");
        }

        // Restart the game
        function restartGame() {
            gameResult.style.display = 'none';
            startGame();
        }

        // Toggle sound
        function toggleSound() {
            gameState.soundsEnabled = !gameState.soundsEnabled;
            const soundIcon = soundToggle.querySelector('i');
            
            if (gameState.soundsEnabled) {
                soundIcon.className = 'fas fa-volume-up';
                soundToggle.title = 'Suara: ON';
            } else {
                soundIcon.className = 'fas fa-volume-mute';
                soundToggle.title = 'Suara: OFF';
            }
        }

        // Event listeners
        rollBtn.addEventListener('click', rollDice);
        
        startBtn.addEventListener('click', () => {
            startGame();
            rulesModal.style.display = 'none';
        });
        
        showRulesBtn.addEventListener('click', () => {
            rulesModal.style.display = 'flex';
        });
        
        closeRulesBtn.addEventListener('click', () => {
            rulesModal.style.display = 'none';
        });
        
        closeBtn.addEventListener('click', () => {
            questionModal.style.display = 'none';
            checkSnakeOrLadder(gameState.players[gameState.currentPlayerIndex].position);
        });
        
        nextBtn.addEventListener('click', () => {
            questionModal.style.display = 'none';
            checkSnakeOrLadder(gameState.players[gameState.currentPlayerIndex].position);
        });
        
        restartBtn.addEventListener('click', restartGame);
        
        menuBtn.addEventListener('click', () => {
            gameResult.style.display = 'none';
            alert("Kembali ke menu utama. Tekan 'Mulai Game' untuk memulai permainan baru.");
        });
        
        exitBtn.addEventListener('click', () => {
            if (confirm("Apakah Anda yakin ingin keluar dari game?")) {
                gameResult.style.display = 'none';
                gameState.gameStarted = false;
                rollBtn.disabled = true;
                alert("Terima kasih telah bermain Game Ular Tangga Digital Sejarah Indonesia!");
            }
        });
        
        soundToggle.addEventListener('click', toggleSound);

        // Initialize the game
        initGameBoard();
        updatePlayerPositions();
        
        // Show rules on first load
        window.addEventListener('load', () => {
            setTimeout(() => {
                rulesModal.style.display = 'flex';
            }, 500);
        });
    </script>
</body>
</html>